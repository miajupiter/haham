import React from 'react'
import BrandLogo from '@/components/BrandLogo/BrandLogo'

import {
  GoogleLogin,
  googleLogout,
  useGoogleLogin,
  GsiButtonConfiguration,
  UseGoogleLoginOptions,
  GoogleOAuthProvider,
} from '@react-oauth/google'
import { Button } from 'flowbite-react'
import jwt_decode from 'jwt-decode'
import FacebookLogin, { FacebookLoginResponse } from 'rc-facebook-login'


const GoogleSignInButton = (props) => {
  const onSuccess = (tokenResponse) => {
    try {
      
      const decoded = jwt_decode(tokenResponse.credential)
      const loginInfo={
        id:decoded.sub,
        name:decoded.name,
        email:decoded.email,
        picture:decoded.picture,
        loginType:'google-oauth2',
        info:decoded,
      }
      localStorage.setItem('loggedIn',true)
      localStorage.setItem('loginInfo',JSON.stringify(loginInfo))

      location.href='/'
      location.reload()

      // console.log('gg decoded:', decoded)
    } catch (err) {
      console.error('tryerr:', err)
    }
  }
  const onError = (err) => {
    console.log('onError:', err)
  }
  const login = useGoogleLogin({
    overrideScope: true,
    onSuccess: onSuccess,
    onError: onError,
    scope: 'email profile openid',
  })

  return (
    <>
      <GoogleLogin
        type={'standard'}
        size='large'
        width='100%'
        auto_select={true}
        onSuccess={onSuccess}
        onError={onError}
        cookiePolicy='single_host_origin'
      />
    </>
  )
}

const FacebookSignInButton = (props) => (
  <>
    <FacebookLogin
      appId={process.env.NEXT_PUBLIC_FACEBOOK_APP_ID}
      callback={(response) => {
        const loginInfo={
          id:response.id,
          name:response.name,
          email:response.email,
          picture:response.picture && response.picture.data.url || '',
          loginType:'facebook',
          info:response,
        }
        localStorage.setItem('loggedIn',true)
        localStorage.setItem('loginInfo',JSON.stringify(loginInfo))

        
        location.href='/'
        location.reload()
      
      }}
      fields='name,email,picture'
      textButton='Sign in with Facebook'
      typeButton='button'
      className='text-white bg-[#3b5998] hover:bg-[#3b599879]  font-medium border rounded-lg text-sm px-5 py-2.5 text-center inline-flex items-center   mr-2 mb-2'
      icon={
        <svg
          className='w-4 h-4 mr-2'
          // ariaHidden='true'
          xmlns='http://www.w3.org/2000/svg'
          fill='currentColor'
          viewBox='0 0 8 19'
        >
          <path
            fillRule='evenodd'
            d='M6.135 3H8V0H6.135a4.147 4.147 0 0 0-4.142 4.142V6H0v3h2v9.938h3V9h2.021l.592-3H5V3.591A.6.6 0 0 1 5.592 3h.543Z'
            clipRule='evenodd'
          />
        </svg>
      }
      cookie={true}
    />
   
  </>
)

const SmsSignInButton = (props) => (
  <button
    type='button'
    className='text-white  bg-[#536416] hover:bg-[#53641679]  font-medium rounded-lg text-sm px-5 py-2.5 text-center inline-flex items-center me-2 mb-2'
    {...props}
  >
    <svg
      className='w-4 h-4 mr-2'
      xmlns='http://www.w3.org/2000/svg'
      width='1em'
      height='1em'
      viewBox='0 0 512 512'
    >
      <path
        fill='currentColor'
        d='M256 448c141.4 0 256-93.1 256-208S397.4 32 256 32S0 125.1 0 240c0 45.1 17.7 86.8 47.7 120.9c-1.9 24.5-11.4 46.3-21.4 62.9c-5.5 9.2-11.1 16.6-15.2 21.6c-2.1 2.5-3.7 4.4-4.9 5.7c-.6.6-1 1.1-1.3 1.4l-.3.3c-4.6 4.6-5.9 11.4-3.4 17.4c2.5 6 8.3 9.9 14.8 9.9c28.7 0 57.6-8.9 81.6-19.3c22.9-10 42.4-21.9 54.3-30.6c31.8 11.5 67 17.9 104.1 17.9zm-53.1-271.2c6.5-2.2 13.7.1 17.9 5.6l35.2 46.9l35.2-46.9c4.1-5.5 11.3-7.8 17.9-5.6S320 185.1 320 192v96c0 8.8-7.2 16-16 16s-16-7.2-16-16v-48l-19.2 25.6c-3 4-7.8 6.4-12.8 6.4s-9.8-2.4-12.8-6.4L224 240v48c0 8.8-7.2 16-16 16s-16-7.2-16-16v-96c0-6.9 4.4-13 10.9-15.2zm173.1 38v.4c.1.1.6.8 2.2 1.7c3.9 2.3 9.6 4.1 18.3 6.8l.6.2c7.4 2.2 17.3 5.2 25.2 10.2c9.1 5.7 17.4 15.2 17.6 29.9c.2 15-7.6 26-17.8 32.3c-9.5 5.9-20.9 7.9-30.7 7.6c-12.2-.4-23.7-4.4-32.6-7.4c-1.4-.5-2.7-.9-4-1.4c-8.4-2.8-12.9-11.9-10.1-20.2s11.9-12.9 20.2-10.1c1.7.6 3.3 1.1 4.9 1.6c9.1 3.1 15.6 5.3 22.6 5.5c5.3.2 10-1 12.8-2.8c1.2-.8 1.8-1.5 2.1-2c.2-.4.6-1.2.6-2.7v-.2c0-.7 0-1.4-2.7-3.1c-3.8-2.4-9.6-4.3-18-6.9l-1.2-.4c-7.2-2.2-16.7-5-24.3-9.6c-9-5.4-17.7-14.7-17.7-29.4c-.1-15.2 8.6-25.7 18.5-31.6c9.4-5.5 20.5-7.5 29.7-7.4c10 .2 19.7 2.3 27.9 4.4c8.5 2.3 13.6 11 11.3 19.6s-11 13.6-19.6 11.3c-7.3-1.9-14.1-3.3-20.1-3.4c-4.9-.1-9.8 1.1-12.9 2.9c-1.4.8-2.1 1.6-2.4 2c-.2.3-.4.8-.4 1.9zm-272 0v.4c.1.1.6.8 2.2 1.7c3.9 2.3 9.6 4.1 18.3 6.8l.6.2c7.4 2.2 17.3 5.2 25.2 10.2c9.1 5.7 17.4 15.2 17.6 29.9c.2 15-7.6 26-17.8 32.3c-9.5 5.9-20.9 7.9-30.7 7.6c-12.3-.4-24.2-4.5-33.2-7.6c-1.3-.4-2.5-.8-3.6-1.2c-8.4-2.8-12.9-11.9-10.1-20.2s11.9-12.9 20.2-10.1c1.4.5 2.8.9 4.1 1.4c9.5 3.2 16.5 5.6 23.7 5.8c5.3.2 10-1 12.8-2.8c1.2-.8 1.8-1.5 2.1-2c.2-.4.6-1.2.6-2.7v-.2c0-.7 0-1.4-2.7-3.1c-3.8-2.4-9.6-4.3-18-6.9l-1.2-.4c-7.2-2.2-16.7-5-24.3-9.6c-9-5.3-17.7-14.6-17.8-29.3c-.1-15.2 8.6-25.7 18.5-31.6c9.4-5.5 20.5-7.5 29.7-7.4c9.5.1 22.2 2.1 31.1 4.4c8.5 2.3 13.6 11 11.3 19.6s-11 13.6-19.6 11.3c-6.6-1.8-16.8-3.3-23.3-3.4c-4.9-.1-9.8 1.1-12.9 2.9c-1.4.8-2.1 1.6-2.4 2c-.2.3-.4.8-.4 1.9z'
      ></path>
    </svg>
    Sign in with SMS
  </button>
)

const EmailSignInButton = (props) => (
  <button
    type='button'
    className='text-white  bg-[#493012] hover:bg-[#49301279]   font-medium rounded-lg text-sm px-5 py-2.5 text-center inline-flex items-center mr-2 mb-2'
    {...props}
  >
    <svg
      className='w-4 h-4 mr-2'
      xmlns='http://www.w3.org/2000/svg'
      width='1em'
      height='1em'
      viewBox='0 0 24 24'
    >
      <path
        fill='currentColor'
        d='M4 20q-.825 0-1.413-.588T2 18V6q0-.825.588-1.413T4 4h16q.825 0 1.413.588T22 6v12q0 .825-.588 1.413T20 20H4Zm8-7l8-5V6l-8 5l-8-5v2l8 5Z'
      ></path>
    </svg>
    Sign in with Email
  </button>
)
const PanelFooter = (props) => (
  <div className='w-full mt-8 space-y-4 text-center text-gray-600 dark:text-gray-400 sm:-mb-8'>
    <p className='text-sm text-start'>
      <span className='mx-2'>By proceeding, you agree to our</span>
      <a
        href='/legal/terms-and-conditions'
        className='text-nowrap underline'
        target='_blank'
      >
        Terms and Conditions
      </a>
      <span className='mx-2'>and confirm you have read our</span>
      <a href='/legal/privacy-policy' className='underline' target='_blank'>
        Privacy and Cookie Statement
      </a>
    </p>

    <div className='flex w-full mt-8'>
      <Button color='dark' outline>
        <svg
          xmlns='http://www.w3.org/2000/svg'
          width='0.63em'
          height='1em'
          viewBox='0 0 320 512'
        >
          <path
            fill='currentColor'
            d='M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l192 192c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256L246.6 86.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-192 192z'
          ></path>
        </svg>
      </Button>
    </div>
  </div>
)

export function Login(props) {
  return (
    <div className='mx-auto mb-auto h-full w-full max-w-md translate-y-1/4'>
      <div className='container relative m-auto px-6 text-gray-500 md:px-8 xl:px-12'>
        <div className='dark:shadow-white-800/60 rounded-xl border border-gray-600 shadow-lg shadow-gray-600/30 dark:border-gray-700'>
          <div className='p-4 pb-12'>
            <div className='space-y-4 text-gray-800 dark:text-white'>
              <div className='flex justify-start'>
                <svg
                  xmlns='http://www.w3.org/2000/svg'
                  viewBox='0 0 606.982 606.982'
                  fill='currentColor'
                  width='43'
                  height='43'
                >
                  <path d='M303.491,0C135.878,0,0,135.878,0,303.491s135.878,303.491,303.491,303.491s303.491-135.878,303.491-303.491    S471.104,0,303.491,0z M425.691,90.781c0.273-5.924,4.444-10.53,9.322-10.283c4.884,0.252,8.616,5.259,8.341,11.187    c-0.273,5.925-4.453,10.519-9.334,10.271C429.144,101.707,425.416,96.707,425.691,90.781z M420.901,173.288    c1.697,3.276,0.391,7.384-2.879,9.065l-67.391,34.693c-1.682,0.86-3.51,0.974-5.141,0.451l0.005,0.002    c-1.63-0.526-3.059-1.686-3.929-3.374c-1.693-3.28-0.393-7.384,2.88-9.067l67.392-34.688    C415.105,168.685,419.208,170.007,420.901,173.288z M401.076,239.727c-0.311,6.682-5.026,11.875-10.528,11.595    c-5.511-0.282-9.723-5.933-9.417-12.614c0.315-6.689,5.028-11.885,10.538-11.603C397.173,227.385,401.384,233.034,401.076,239.727z    M331.899,58.745l19.342-31.103l5.262,36.615l34.447,9.881l-30.913,17.605l0.651,36.032l-24.855-24.505l-32.244,12.082    l14.715-33.076l-20.768-28.322L331.899,58.745z M306.636,305.187c-3.582,0.643-7.564,1.378-11.726,2.224    c-3.839-8.715-10.239-24.801-10.567-33.101c0.338-0.442,0.625-0.87,0.926-1.245c1.6-1.967,3.168-3.709,4.641-5.414    c5.487-6.249,10.195-11.631,12.547-22.225c1.537-6.994,1.836-14.27,0.82-20.487c-0.16-0.923-0.348-1.78-0.537-2.636    c1.486,0.678,2.824,1.572,4.107,2.757c2.677,2.55,4.765,6.224,6.187,10.94c1.458,4.82,3.187,14.808,4.847,24.447    c1.743,10.039,3.357,19.523,4.893,24.588c1.711,5.707,9.157,15.398,15.893,23.381c-6.813-3.34-14.414-6.461-32.105-3.256    L306.636,305.187z M317.039,192.697c-1.111,0.764-2.491,1.141-3.895,0.962c-2.735-0.342-4.462-2.839-3.825-5.506l13.229-55.059    c0.639-2.67,3.432-4.595,6.163-4.251c2.737,0.344,4.464,2.838,3.825,5.509l-13.224,55.058c-0.333,1.375-1.167,2.522-2.278,3.289    L317.039,192.697z M250.915,127.134c0.233-5.028,3.77-8.926,7.904-8.718c4.135,0.214,7.296,4.453,7.064,9.482    c-0.234,5.021-3.771,8.92-7.904,8.709C253.841,136.396,250.683,132.156,250.915,127.134z M156.889,50.227    c10.903,6.463,22.594,8.072,35.09,4.83c12.499-3.242,21.643-10.262,27.454-21.059l1.336,0.792    c-5.789,10.765-6.792,22.61-2.989,35.534c3.795,12.916,11.158,22.602,22.063,29.063l-0.713,1.324    c-10.901-6.461-22.608-8.079-35.093-4.828c-12.495,3.232-21.643,10.262-27.448,21.052l-1.34-0.794    c5.802-10.789,6.814-22.643,2.996-35.545c-3.811-12.903-11.17-22.582-22.071-29.041L156.889,50.227z M198.958,208.801    c-0.25,5.36-4.038,9.523-8.453,9.299c-4.418-0.227-7.801-4.754-7.553-10.117c0.25-5.376,4.033-9.537,8.454-9.312    C195.823,198.895,199.208,203.424,198.958,208.801z M105.163,178.463c-9.577-7.232-19.614-9.346-30.112-6.336l-0.29-1.553    c10.494-3.007,18.792-10.38,24.903-22.122c6.097-11.739,7.981-23.941,5.646-36.642l1.296-0.366    c2.315,12.649,8.278,22.608,17.869,29.868c9.588,7.272,19.616,9.385,30.112,6.377l0.285,1.551    c-10.487,3.01-18.788,10.38-24.887,22.122c-6.108,11.728-7.988,23.938-5.661,36.642l-1.285,0.367    C120.707,195.682,114.751,185.713,105.163,178.463z M176.294,342.266c-15.465-24.509-38.793-61.494-48.543-75.815    c-12.105-17.796-10.959-23.895-10.316-25.314c0.542-1.276,2.153-2.104,4.747-2.462c13.873-1.99,31.088,14.09,36.385,25.613    c5.791,12.6,35.267,44.139,39.576,48.726c-4.57,8.431-5.425,19.427-5.323,27.7l-0.007,0.002c0.197,10.743,2.26,22.463,5.319,29.871    c0.637,1.517,1.197,3.443,1.662,5.725C193.195,367.467,184.468,355.178,176.294,342.266z M198.756,159.707v0.004    c-0.384-1.822-0.19-3.75,0.663-5.396c1.665-3.2,5.374-3.911,8.201-1.571l58.225,48.235c2.824,2.338,3.785,6.921,2.125,10.12    c-1.655,3.2-5.371,3.914-8.194,1.572l-58.225-48.234C200.097,163.232,199.139,161.528,198.756,159.707z M428.058,560.977    c-6.203,2.484-21.086,12.844-26.512,12.367c-1.004-2.503-12.119-24.982-12.992-27.364c-3.645-10.032-7.139-19.628-16.705-26.682    c4.653-0.527,8.83-1.49,12.512-2.767c14.74-5.115,22.169-15.02,26.353-20.655c0.493-0.607,0.896-1.179,1.311-1.705    c1.581-2.015,1.218-4.932-0.794-6.513c-2.02-1.584-4.935-1.221-6.518,0.793c-0.449,0.594-0.896,1.18-1.42,1.852    c-3.395,4.489-8.47,11.299-17.795,15.73c-11.525,5.464-26.715,5.848-45.144,1.269c-7.118-1.874-14.97-3.823-22.667-5.655    c-18.174-4.453-38.764-9.475-44.977-12.968c-10.248-5.729-11.543-9.139-15.025-40.306c-2.809-24.985,4.219-57.781,7.553-73.551    c0.658-3.104,1.167-5.561,1.438-7.123c0.013-0.111,0.535-2.68,9.918-6.809c6.65-2.905,15.333-5.592,22.994-7.923    c2.805-0.864,5.404-1.66,7.846-2.45c16.381-5.25,23.289-5.523,34.581,2.881c4.323,3.225,7.854,5.422,10.706,7.205    c6.164,3.835,7.479,4.795,8.111,8.646c0.067,0.197,0.067,0.523-0.652,1.096c-3.49,2.787-14.154,3.822-21.254,1.074    c-0.373-0.145-9.264-3.524-18.121,2.266c-6.826,4.433-16.604,10.381-16.688,10.462c-1.436,0.878-2.287,2.475-2.256,4.151    c0.052,0.141,0.279,8.922-0.314,18.955l0.047,0.148c-0.535,7.844-1.567,16.453-3.638,22.387c-0.843,2.413,0.405,5.074,2.82,5.924    c2.407,0.845,5.073-0.408,5.923-2.818c1.207-3.405,2.116-7.521,2.76-11.77c2.17,3.764,4.252,7.706,6,11.499    c4.119,8.894,5.305,14.347,5.101,16.264c-0.257,2.536,1.569,4.832,4.122,5.139c0.682,0.095,1.414,0,2.041-0.216    c1.646-0.57,2.93-2.047,3.107-3.899c0.593-5.638-2.912-14.632-5.896-21.2c-3.649-7.855-8.33-16.012-13.034-22.522    c0.341-6.53,0.35-12.29,0.28-15.467c3.366-2.035,9.76-5.996,14.624-9.202c4.702-3.047,9.315-1.498,9.621-1.387    c4.404,1.729,10.155,2.506,15.788,2.125c3.574-0.207,10.215-1.1,14.632-4.641c3.182-2.569,4.636-6.063,4.036-9.819    c-1.287-8.243-5.918-11.086-12.359-15.099c-2.7-1.672-6.088-3.754-10.068-6.775c-14.52-10.822-24.961-10.076-43.007-4.304    c-2.392,0.775-4.995,1.571-7.745,2.413c-7.905,2.418-16.9,5.16-24.004,8.327c-9.719,4.241-14.486,8.506-15.379,13.757    c-0.223,1.379-0.751,3.789-1.393,6.785c-3.482,16.246-10.65,50.072-7.711,76.537c0.787,7.107,1.476,13.012,2.217,17.965    c-9.728-2.976-17.024-10.226-17.968-18.429c-0.421-3.868-0.708-12.675-0.718-23.647c-0.017-2.545-2.103-4.643-4.652-4.631    c-2.547,0.019-4.645,2.102-4.633,4.65c-0.016,5.111,0.058,9.7,0.165,13.63c-4.105-4.007-7.896-8.505-8.748-11.896    c-0.847-3.235-1.387-11.193-1.928-19.647c-0.998-14.91-2.128-31.787-5.659-40.236c-2.145-5.229-4.441-15.455-4.631-26.469    c-0.206-11.555,1.931-20.715,5.967-25.859c10.369-13.152,51.031-67.234,56.466-75.206c14.336-20.833,20.907-23.98,23.063-24.348    c0.567-0.085,0.711,0.026,0.777,0.056c3.604,2.555,5.061,7.53,5.692,11.224c0.792,5.101,0.56,11.159-0.716,17.032    c-1.817,8.232-5.283,12.154-10.457,18.074c-1.439,1.641-3.121,3.527-4.832,5.643c-0.688,0.837-1.375,1.832-2.121,2.965    c-0.108,0.148-0.178,0.275-0.287,0.424c-7.613,12.037-18.365,38.962-20.996,45.627c-5.889,1.503-10.547,2.791-13.066,3.828    c-5.297,2.11-8.41,5.525-10.458,11.344c-1.841,5.199-3.01,12.777-4.784,24.252c-1.39,8.847-2.17,21.772-2.573,31.092    c-0.132,2.602,1.859,4.73,4.457,4.862c2.549,0.149,4.733-1.859,4.865-4.457c0.604-12.974,1.431-23.416,2.485-30.081    c3.519-22.889,4.385-26.346,9.492-28.385c7.348-2.926,40.615-10.232,63.21-14.33c15.692-2.834,20.938-0.258,27.57,3.038    c2.351,1.142,4.983,2.452,8.144,3.585c4.629,1.6,8.939,2.113,12.777,2.52c6.839,0.774,9.157,1.333,10.409,4.48    c2.281,5.781-4.285,10.504-4.64,10.731c-2.109,1.438-2.626,4.331-1.188,6.441c1.208,1.751,3.454,2.44,5.344,1.782    c0.394-0.131,0.762-0.314,1.118-0.546c1.88-1.306,4.342-3.624,6.198-6.55c10.043,6.07,23.279,20.271,36.638,39.48    c13.237,19.029,21.8,36.047,23.152,42.421c3.528,16.591,15.979,36.331,22.761,45.384c5.205,6.955,26.875,34.818,35.563,50.73    C485.733,536.106,436.544,557.607,428.058,560.977z M485.872,193.348c-16.414,4.568-28.682,14.239-36.813,29.008l-1.699-1.061    c8.139-14.768,10.078-30.918,5.83-48.436c-4.252-17.506-13.287-30.602-27.105-39.258l0.998-1.803    c13.818,8.651,28.938,10.695,45.337,6.131c16.414-4.566,28.685-14.238,36.83-29.006l1.687,1.06    c-8.1,14.72-10.041,30.866-5.811,48.41c4.239,17.527,13.262,30.614,27.094,39.283l-0.996,1.807    C517.394,190.826,502.282,188.783,485.872,193.348z'></path>
                </svg>
                <div className='ml-2 text-3xl font-bold'>MiaJupiter</div>
              </div>
            </div>
            <div className='mt-12 grid grid-flow-row space-y-4'>
              <GoogleSignInButton />
              <FacebookSignInButton />
              <EmailSignInButton />
              <SmsSignInButton />
            </div>
            <PanelFooter />
          </div>
        </div>
      </div>
    </div>
  )
}

export default Login
